---
title: Python笔记_装饰器
categories: '04_学习笔记'
tags:
  - python
date: 2018-06-12 22:13:26
---

**概述：** 装饰器作为python中的高级用法，有些地方理解起来还是有点绕。所以自己做了一下"反套路"，其实理解起来还是蛮容易的了..

<!-- more -->

# Python装饰器

@[TOC]

## 闭包

需要满足一下条件：

- 一个`嵌套(nested)`函数
- 嵌套函数返回`封闭(enclosing)`函数的变量
- 封闭函数需要`return`嵌套函数

例如：

``` python
def foo(msg):
    def bar():
        return msg
    return bar

x = foo('hello')
print(x())

输出：
hello
```

### 用途

可以用来让上层函数（指closing函数）的变量持久化（设置个初值或者定值）。

``` python
def foo(x):
    def bar(var):
        return x + var
    return bar

# 我一开始有10ml牛奶和20ml水
water = foo(10)
milk = foo(20)

# 我各买20ml, 现在我有30ml水，40ml牛奶
# 初始值被保留了
print(water(20))
print(milk(20))

# 因此这个方法可以用于设置初值
```

### 如何让局部变量变得外层可以访问

``` python
def outer_function():
    a = 5
    def inner_function():
        nonlocal a  # 关键在于这个
        a = 10
        print("Inner function: ",a)
    inner_function()
    print("Outer function: ",a)

outer_function()

输出：
Inner function:  10
Outer function:  5
```

## 声明

**版权：** 2018-now，:cn:，zangjiaao\<zangjiaao@yahoo.com>

由家浩创作并维护的`zangjiaao's blog`博客所有文章除特别声明外，均采用"署名-非商业性使用-相同方式共享4.0(CC BY-NC-SA 4.0)[国际许可证](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)"。

本文首发于[zangjiaao's blog](https://blog.zangjiaao.cn/)博客，转载请注明出处。
