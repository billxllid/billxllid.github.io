---
title: Shell编程速查
categories: '03_工具手册'
tags:
  - shell
date: 2018-06-12 00:59:02
---

**概述：** 学习老男孩shell编程的一些笔记吧，python和shell必须要会啊！加油.. :yum:

<!-- more -->

# Shell编程速查

@[TOC]

## TODO

[Ubuntu学习——第一篇 - R_e - 博客园](http://www.cnblogs.com/resn/p/5800922.html)

[sed命令_Linux sed 命令用法详解：功能强大的流式文本编辑器](http://man.linuxde.net/sed)

## 环境变量

### 设置、使用、取消

- `export`: 设置变量
- `env`: 显示当前所有变量
- `echo $PATH`: 显示PATH变量的值，前面加`$`
- `echo ${PATH}`: 同上
- `unset`: 取消设置变量

### 引号使用规则

- `' '`: 单引号包裹内容，所见即所得，不会执行其中的命令
- `" "`: 双引号中的变量和反引号内容会被执行。例如`echo "$PATH"`会显示PATH变量，而`echo '$PATH'`则不会
- `sed`与`grep`都遵循以上规则，但是`awk`比较特殊，如下：

#### awk特殊规则

但是，在`awk`中的定义正好**相反**，例如：

``` bash
TEST_ME=123
awk 'BEGIN {print '$TEST_ME'}'
  123
awk 'BEGIN {print "$TEST_ME"}'
  $TEST_ME
awk 'BEGIN {print $TEST_ME}'
  awk: illegal field $(), name "TEST_ME"
   source line number 1
# 两个比较特殊的情况
awk 'BEGIN {print '"$TEST_ME"'}'
  123
awk 'BGGIN {print "'$TEST_ME'"}'
  123
```

因此一半的做法是使用`echo`然后管道给`awk`，例如：

``` bash
TEST_ME=123
echo "$TEST_ME"|awk '{print $0}'
  123
echo '$TEST_ME'|awk '{print $0}'
  $TEST_ME
echo $TEST_ME|awk '{print $0}'
  123
```

### 特殊变量

`$0`: 当前执行shell脚本的文件名，包含路径则是路径
`$n`: 代表第n个参数，支持`$1..9`，大于9需要用`${10}`表示
`$#`: 代表参数总数量
`$*`: 代表所有参数，`"$*"`相当于`$1 $2 ..`
`$@`: 代表所有参数（因此不加引号同`$*`），`"$@"`相当于`"$1","$2"..`

## crontab

**From:** [Ubuntu学习_博客园](http://www.cnblogs.com/resn/p/5800922.html)

- `-u user`：用来设定某个用户的crontab服务；
- `-e`：编辑某个用户的crontab文件内容。如果不指定用户，则表示编辑当前用户的crontab文件。
- `-l`：显示某个用户的crontab文件内容，如果不指定用户，则表示显示当前用户的crontab文件内容。
- `-r`：从/var/spool/cron目录中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件。
- `-i`：在删除用户的crontab文件时给确认提示

```
* * * * * command to be executed
- - - - - -
| | | | | |
| | | | | --- 预执行的命令
| | | | ----- 表示星期0～7（其中星期天可以用0或7表示）
| | | ------- 表示月份1～12
| | --------- 表示日期1～31
| ----------- 表示小时1～23（0表示0点）
------------- 表示分钟1～59 每分钟用*或者 */1表示
```

## sed

```
sed [-nefr] [动作] [文件]
```

**选项与参数**:

- `-n`：使用安静(silent)模式。在一般 sed 的用法中，所有来自 STDIN 的数据一般都会被列出到终端上。但如果加上 -n 参数后，则只有经过sed 特殊处理的那一行(或者动作)才会被列出来
- `-e`：直接在命令列模式上进行 sed 的动作编辑
- `-f`：直接将 sed 的动作写在一个文件内， -f filename 则可以运行 filename 内的 sed 动作
- `-r`：sed 的动作支持的是延伸型正规表示法的语法。(默认是基础正规表示法语法)
- `-i`：直接修改读取的文件内容，而不是输出到终端。

**动作**:

- `[n1[,n2]] (动作)`: 表示指定修改的行范围, 从n1到n2, 为空表示全文范围;
- `a`: 新增, a的后面可以接字串，而这些字串会在新的一行出现(目前的下一行);
- `c`: 替换, c的后面可以接字串，这些字串可以取代 n1,n2 之间的行;
- `d`: 删除, 因为是删除啊，所以 d 后面通常不接任何咚咚；
- `i`: 插入,

**范例**:

使用下面的命令创建了测试样本:

``` shell
for i in {1..10};do touch i.txt; echo "$i" >> i.txt;done;
```

删除实例:

```
# 删除单行
sed -e "1d" i.txt

# 删除单行(正则方式)
sed -e "/4/d" i.txt  # 删除包含4的行

# 删除多行
sed -e "1,3d" i.txt  # 删除1至3行
sed -e "1d;3d;5d" i.txt  # 删除1,3,5行

# 删除多行(正则方式)
sed -e "/4/,/8/d" i.txt  # 删除从包含4的行到包含8的行(包含自己)
sed -e "1,/8/d" i.txt  # 删除从第一行开始到第一个包含8的行
```

## ip命令

CentOS7以后将使用ip命令替代ifconfig等网络管理命令, 下面介绍一下该命令的用法.

### address

``` shell
# 查看接口信息
ip address show
ip address show dev ens36

# 为接口指定IP地址(还可以打label)
ip address add 192.0.2.1/27 dev ens36
ip address add 192.0.2.1/29 dev ens36 lablel ens36:hahaha
# 修改
ip addr change 10.0.2.4/24 dev eth0
# 删除
ip addr del 10.0.2.4/24 dev eth0

# 清除指定接口的配置
ip address flush dev ens36
```

### route

``` shell
# 查看
ip -4 route  # 仅查看ipv4的
ip route
ip route show
ip route show match 192.168.56.0

# 添加、修改、删除
ip route add 192.192.13.1/24 via 10.13.77.1
ip route add default via 10.13.77.1  # 添加默认路由
# 删除
ip route delete 192.192.13.1/24
ip route delete 192.192.13.1/24 via 10.13.77.1
# 修改
ip route change default via 192.168.0.1  # 修改默认路由
ip route change 192.192.13.1/24 dev ens32
```

### 更多

参考[Linux ip route command reference by examples &#8211; yurisk.info](https://yurisk.info/2016/12/19/linux-ip-route-command-reference-by-example/index.html).

## 声明

**版权：** 2018-now，:cn:，zangjiaao\<zangjiaao@yahoo.com>

由家浩创作并维护的`zangjiaao's blog`博客所有文章除特别声明外，均采用"创作共用保留署名-非商业-禁止演绎4.0国际[许可证](https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh)"。

本文首发于[zangjiaao's blog](https://blog.zangjiaao.cn/)博客，转载请注明出处。
