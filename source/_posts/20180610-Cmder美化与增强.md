---
title: Cmder美化与增强
categories: '05_日常折腾'
tags:
  - cmder
date: 2018-06-10 03:14:43
---

# Cmder 配置

@[TOC]

效果图：

{% asset_path '20180610-Cmder美化与增强' %}
{% asset_img '效果图.png' 效果图 %}

---

## 安装 Chocolatey 包管理

> **参考：** [Pimping Up Your PowerShell & Cmder with Posh-Git, Oh-My-Posh, & Powerline Fonts](https://gist.github.com/jchandra74/5b0c94385175c7a8d1cb39bc5157365e)

使用管理员身份打开 Powershell，执行下面的命令修改执行权限：

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Force
```

这里 PS 可能会报错，权限除了`RemoteSigned`还可以改为`ByPass`、`Unrestricted`，执行`Get-ExecutionPolicy`检查当前状态。

随后使用下面命令安装 chocolatey：

```powershell
iwr https://chocolatey.org/install.ps1 -UseBasicParsing | iex
```

## 安装 Cmder

### 方法 a：Chocolatey

执行下面命令进行安装：

```powershell
cinst cmder -y
```

这个方法貌似不带 git 等工具，还需要单独安装，我选择方法 b 安装。

### 方法 b：官网下载 full 版本

直接去官网下载。

## 安装 Powerline 字体

运行下面命令：

```powershell
git clone https://github.com/powerline/fonts.git
cd fonts
.\install.ps1
```

但是这个方法安装的是所有字体，比较慢也没有必要，只需要安装[这个字体](https://raw.githubusercontent.com/powerline/fonts/master/Meslo%20Slashed/Meslo%20LG%20M%20Regular%20for%20Powerline.ttf)即可。

## 安装 Posh-Git 及 Oh-My-Posh

> **简介：** Posh-Git (PowerShell Git) 主要用于当你进入一个包含 git 项目时，显示项目信息。Oh-My-Posh 则主要用于定义 Posh-Git 的主题。

运行下面的命令安装`Posh-Git`：

```powershell
Install-PackageProvider NuGet -MinimumVersion '2.8.5.201' -Force
Set-PSRepository -Name PSGallery -InstallationPolicy Trusted
Install-Module -Name 'posh-git'
```

运行下面的命令安装`Oh-My-Posh`:

```powershell
Install-Module -Name 'oh-my-posh'
```

可以前往[oh-my-posh](https://github.com/JanDeDobbeleer/oh-my-posh)预览主题。

## 安装 Get-ChildItemColor

> **简介：** 主要用于定义列目录风格，`Get-ChildItemColor`是传统 PS 风格，`Get-ChildItemColorFormatWide`是类 Unix 风格，下面配置文件里面也会映射`l`及`ls`来替代。

运行下面的命令进行安装：

```powershell
Install-Module -Name 'Get-ChildItemColor'
```

## 配置 PowerShell 的$PROFILE

这里默认的$PROFILE 是`C:\Users\18354\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1`，如果修改这个文件会联动到 Powershell，但是我比较习惯只修改 cmder 的配置文件`%CMDER_ROOT%\vendor\profile.ps1`，只需要在最后追加下面内容即可：

```powershell
# Ensure that Get-ChildItemColor is loaded
Import-Module Get-ChildItemColor

# Set l and ls alias to use the new Get-ChildItemColor cmdlets
Set-Alias l Get-ChildItemColor -Option AllScope
Set-Alias ls Get-ChildItemColorFormatWide -Option AllScope

# Helper function to change directory to my development workspace
# Change c:\ws to your usual workspace and everytime you type
# in cws from PowerShell it will take you directly there.
function cws { Set-Location c:\ws }

# Helper function to set location to the User Profile directory
function cuserprofile { Set-Location ~ }
Set-Alias ~ cuserprofile -Option AllScope

# Helper function to show Unicode character
function U
{
    param
    (
        [int] $Code
    )

    if ((0 -le $Code) -and ($Code -le 0xFFFF))
    {
        return [char] $Code
    }

    if ((0x10000 -le $Code) -and ($Code -le 0x10FFFF))
    {
        return [char]::ConvertFromUtf32($Code)
    }

    throw "Invalid character code $Code"
}

# Ensure posh-git is loaded
Import-Module -Name posh-git

# Start SshAgent if not already
# Need this if you are using github as your remote git repository
if (! (ps | ? { $_.Name -eq 'ssh-agent'})) {
    Start-SshAgent
}

# Ensure oh-my-posh is loaded
Import-Module -Name oh-my-posh

# Default the prompt to agnoster oh-my-posh theme
Set-Theme agnoster
```

## 声明

**版权：** 2018-now，:cn:，zangjiaao\<zangjiaao@yahoo.com>

由家浩创作并维护的`zangjiaao's blog`博客所有文章除特别声明外，均采用"创作共用保留署名-非商业-禁止演绎4.0国际[许可证](https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh)"。

本文首发于[zangjiaao's blog](https://blog.zangjiaao.cn/)博客，转载请注明出处。
